<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>EcoTek Key Manager</title>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: monospace;
      padding: 30px;
    }
    input, select, button, textarea {
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      margin: 4px 0;
      width: 100%;
    }
    .btn {
      cursor: pointer;
      margin-top: 10px;
    }
    .danger { color: red; }
    .json-output {
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      white-space: pre;
    }
    .label { margin-top: 20px; display: block; font-weight: bold; }
    .title {
      font-size: 28px;
      color: #00ffff;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <div class="title">üîê EcoTek Key Manager</div>

  <label class="label">üë§ T√™n t√†i kho·∫£n:</label>
  <input type="text" id="username" placeholder="Nh·∫≠p username">

  <label class="label">üîë Key:</label>
  <input type="text" id="key" placeholder="Nh·∫≠p key">

  <label class="label">‚è±Ô∏è H·∫°n s·ª≠ d·ª•ng:</label>
  <select id="duration">
    <option value="1h">1 gi·ªù</option>
    <option value="12h">12 gi·ªù</option>
    <option value="1d">1 ng√†y</option>
    <option value="10d">10 ng√†y</option>
    <option value="forever">Vƒ©nh vi·ªÖn</option>
  </select>

  <label><input type="checkbox" id="noHash"> ‚úÖ KH√îNG m√£ h√≥a key (test)</label>

  <button class="btn" onclick="addAccount()">‚ûï T·∫°o t√†i kho·∫£n</button>
  <button class="btn danger" onclick="removeAccount()">‚ùå X√≥a t√†i kho·∫£n</button>
  <button class="btn" onclick="copyJSON()">üìã Sao ch√©p JSON</button>

  <textarea id="jsonOutput" class="json-output" rows="10" placeholder="JSON s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y"></textarea>
  <p><i>* IP v√† thi·∫øt b·ªã s·∫Ω t·ª± ƒë·ªông l·∫•y khi t·∫°o t√†i kho·∫£n</i></p>

<script>
let accounts = {};

function getExpires(type) {
  const now = Date.now();
  switch (type) {
    case "1h": return now + 1 * 60 * 60 * 1000;
    case "12h": return now + 12 * 60 * 60 * 1000;
    case "1d": return now + 24 * 60 * 60 * 1000;
    case "10d": return now + 10 * 24 * 60 * 60 * 1000;
    case "forever": return 9999999999999;
  }
}

async function sha256(str) {
  const buf = new TextEncoder().encode(str);
  const hash = await crypto.subtle.digest("SHA-256", buf);
  return Array.from(new Uint8Array(hash)).map(x => x.toString(16).padStart(2, '0')).join('');
}

async function addAccount() {
  const username = document.getElementById('username').value.trim();
  const keyRaw = document.getElementById('key').value.trim();
  const duration = document.getElementById('duration').value;
  const noHash = document.getElementById('noHash').checked;

  if (!username || !keyRaw) return alert("Thi·∫øu th√¥ng tin!");

  const expires = getExpires(duration);
  const ip = (await (await fetch("https://api.ipify.org?format=json")).json()).ip;
  const device = navigator.userAgent;
  const key = noHash ? keyRaw : await sha256(keyRaw);

  accounts[username] = { key, expires, ip, device, active: true };
  render();
}

function removeAccount() {
  const username = document.getElementById('username').value.trim();
  if (!username || !(username in accounts)) return alert("T√†i kho·∫£n kh√¥ng t·ªìn t·∫°i!");
  delete accounts[username];
  render();
}

function render() {
  document.getElementById("jsonOutput").value = JSON.stringify(accounts, null, 2);
}

function copyJSON() {
  const txt = document.getElementById("jsonOutput");
  txt.select();
  document.execCommand("copy");
  alert("‚úÖ ƒê√£ sao ch√©p JSON!");
}
</script>

</body>
</html>
